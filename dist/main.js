!function(){"use strict";!function(){let e=null;function t(t){e=t;const n=document.getElementById("searchInput"),s=document.getElementById("searchResults");let o;n.addEventListener("input",(t=>{t.target.value?s.style.border="1px solid #ccc":s.style.border="none",clearTimeout(o),o=setTimeout((()=>{!async function(t){const n=`https://api.spotify.com/v1/search?q=${encodeURIComponent(t)}&type=show,episode,track&limit=5`,s={Authorization:`Bearer ${e}`,"Content-Type":"application/json"};try{let t=await fetch(n,{headers:s});401===t.status&&(await async function(){try{const t=await fetch(`https://podify-backend.onrender.com/refresh_token?refresh_token=${localStorage.getItem("refresh_token")}`),n=await t.json();e=n.access_token,localStorage.setItem("access_token",e)}catch(e){console.error("Error refreshing token:",e)}}(),t=await fetch(n,{headers:s}));const o=await t.json(),a=[];return o.shows&&o.shows.items&&a.push(...o.shows.items.map((e=>({type:"show",id:e.id,name:e.name})))),o.tracks&&o.tracks.items&&a.push(...o.tracks.items.map((e=>({type:"track",id:e.id,name:e.name})))),o.episodes&&o.episodes.items&&a.push(...o.episodes.items.map((e=>({type:"episode",id:e.id,name:e.name})))),function(e){const t=document.getElementById("searchResults");t.innerHTML="",e.forEach((e=>{const n=document.createElement("div");n.className="resultItem",n.dataset.id=e.id,n.dataset.type=e.type,n.innerHTML=`<strong>${e.type}:</strong> ${e.name}`,t.appendChild(n)}))}(a),a}catch(e){return console.error("Error searching Spotify:",e),[]}}(t.target.value)}),500)}))}let n=null;const s=document.getElementById("loginButton");s.addEventListener("click",(()=>{window.location.href="https://podify-backend.onrender.com/login"})),window.addEventListener("load",(()=>{const e=window.location.hash.substring(1),o=new URLSearchParams(e);if(o.has("access_token")){s.style.display="none";const e=o.get("access_token"),a=o.get("token_type"),c=o.get("expires_in");document.getElementById("search-container").style.display="block",console.log({access_token:e,token_type:a,expires_in:c}),function(e){fetch("https://api.spotify.com/v1/me",{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"}}).then((e=>e.json())).then((e=>{var t;t=e.display_name,document.getElementById("username").textContent=t})).catch((e=>{console.error("Error fetching user profile:",e)}))}(e),t(e);const r=document.getElementById("searchInput");r.style.display="block";const i=document.getElementById("searchResults");r.addEventListener("input",(()=>{r.value.length>0?i.style.display="block":i.style.display="none"})),function(e){n=e,document.getElementById("searchResults").addEventListener("click",(e=>{e.target.classList.contains("resultItem")&&async function(e,t){const s={Authorization:`Bearer ${n}`,"Content-Type":"application/json"},o={context_uri:`spotify:${t}:${e}`};try{const n=await fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:s,body:JSON.stringify(o)});if(!n.ok)throw new Error(`Unable to play ${t}: ${n.statusText}`);console.log(`Successfully started playing ${t} with ID: ${e}`)}catch(e){console.error("Error in web player:",e)}}(e.target.dataset.id,e.target.dataset.type)}))}(e)}})),player.addListener("player_state_changed",(e=>{console.log(e),o=!e.paused,document.getElementById("playPause").textContent=o?"⏸️":"▶️"})),document.getElementById("searchInput").addEventListener("focus",(e=>{e.preventDefault()})),document.getElementById("playPause").addEventListener("click",(function(){o?player.pause().then((()=>{console.log("Paused Playback"),o=!1,document.getElementById("playPause").textContent="▶️"})):player.resume().then((()=>{console.log("Resumed Playback"),o=!0,document.getElementById("playPause").textContent="⏸️"}))})),document.getElementById("rewind").addEventListener("click",(function(){player.seek(player.getCurrentState().position-15e3)})),document.getElementById("fastForward").addEventListener("click",(function(){player.seek(player.getCurrentState().position+15e3)}));let o=!1;document.getElementById("webPlayer").style.display="block"}()}();
//# sourceMappingURL=main.js.map