{"version":3,"file":"main.js","mappings":"qCAAA,IAAIA,EAAc,KAEX,SAASC,EAAYC,GAI1B,IAAIC,EAHJH,EAAcE,EAEME,SAASC,eAAe,eAEhCC,iBAAiB,SAAUC,IACrCC,aAAaL,GACbA,EAAQM,YAAW,MAiBvBC,eAA6BC,GAC3B,MAAMC,EAAkB,uCAAsCC,mBAAmBF,qCAC3EG,EAAU,CACd,cAAkB,UAASd,IAC3B,eAAgB,oBAGlB,IACE,IAAIe,QAAiBC,MAAMJ,EAAgB,CAAEE,QAASA,IAG9B,MAApBC,EAASE,eAtBjBP,iBACE,IACE,MAAMK,QAAiBC,MAAO,mEAAkEE,aAAaC,QAAQ,oBAC/GC,QAAaL,EAASM,OAC5BrB,EAAcoB,EAAKE,aACnBJ,aAAaK,QAAQ,eAAgBvB,EACvC,CAAE,MAAOwB,GACPC,QAAQD,MAAM,0BAA2BA,EAC3C,CACF,CAcYE,GACNX,QAAiBC,MAAMJ,EAAgB,CAAEE,QAASA,KAGpD,MAAMM,QAAaL,EAASM,OACtBM,EAAU,GAmBhB,OAjBIP,EAAKQ,OAASR,EAAKQ,MAAMC,OAC3BF,EAAQG,QAAQV,EAAKQ,MAAMC,MAAME,KAAIC,IAAQ,CAC3CC,KAAM,OACNC,KAAMF,EAAKE,UAIXd,EAAKe,QAAUf,EAAKe,OAAON,OAC7BF,EAAQG,QAAQV,EAAKe,OAAON,MAAME,KAAIC,IAAQ,CAC5CC,KAAM,QACNC,KAAMF,EAAKE,UAcnB,SAAwBP,GACtB,MAAMS,EAAmBhC,SAASC,eAAe,iBACjD+B,EAAiBC,UAAY,GAE7BV,EAAQW,SAAQC,IACd,MAAMC,EAAgBpC,SAASqC,cAAc,OAC7CD,EAAcE,UAAY,gBAC1BF,EAAcG,YAAe,GAAEJ,EAAON,SAASM,EAAOL,OACtDE,EAAiBQ,YAAYJ,EAAc,GAE/C,CAnBIK,CAAelB,GAERA,CACT,CAAE,MAAOH,GAEP,OADAC,QAAQD,MAAM,2BAA4BA,GACnC,EACT,CACF,CAzDMsB,CAAcvC,EAAEwC,OAAOC,MAAM,GAC5B,IAAI,GAEX,CCVA,MAEMC,EAAc7C,SAASC,eAAe,eAC5C4C,EAAY3C,iBAAiB,SAAS,KACpC4C,OAAOC,SAASC,KAAO,2CAA2C,IAGpEF,OAAO5C,iBAAiB,QAAQ,KAC9B,MAAM+C,EAAOH,OAAOC,SAASE,KAAKC,UAAU,GACtCC,EAAa,IAAIC,gBAAgBH,GAEvC,GAAIE,EAAWE,IAAI,gBAAiB,CAClCR,EAAYS,MAAMC,QAAU,OAE5B,MAAM3D,EAAcuD,EAAWK,IAAI,gBAC7BC,EAAYN,EAAWK,IAAI,cAC3BE,EAAYP,EAAWK,IAAI,cACTxD,SAASC,eAAe,oBAChCqD,MAAMC,QAAU,QAEhClC,QAAQsC,IAAI,CACVzC,aAActB,EACdgE,WAAYH,EACZI,WAAYH,IASlB,SAAwB9D,GAMtBgB,MAAM,gCAAiC,CAAEF,QALzB,CACdoD,cAAgB,UAASlE,IACzB,eAAgB,sBAIfmE,MAAKpD,GAAYA,EAASM,SAC1B8C,MAAK/C,IASV,IAAwBgD,IARDhD,EAAKiD,aASFjE,SAASC,eAAe,YAChCsC,YAAcyB,CATF,IAEzBE,OAAM9C,IACLC,QAAQD,MAAM,+BAAgCA,EAAM,GAE1D,CArBI+C,CAAevE,GACfC,EAAYD,GACZI,SAASC,eAAe,eAAeqD,MAAMC,QAAU,OACzD,I","sources":["webpack://podify/./src/searchBar.js","webpack://podify/./src/index.js"],"sourcesContent":["let accessToken = null;\n\nexport function setupSearch(accessTokenValue) {\n  accessToken = accessTokenValue;\n\n  const searchInput = document.getElementById('searchInput');\n  let timer;\n  searchInput.addEventListener('input', (e) => {\n    clearTimeout(timer);\n    timer = setTimeout(() => {\n      searchSpotify(e.target.value);\n    }, 500);  // Half a second delay to reduce the number of requests\n  });\n}\n\nasync function refreshToken() {\n  try {\n    const response = await fetch(`https://podify-backend.onrender.com/refresh_token?refresh_token=${localStorage.getItem('refresh_token')}`);\n    const data = await response.json();\n    accessToken = data.access_token;\n    localStorage.setItem('access_token', accessToken);\n  } catch (error) {\n    console.error('Error refreshing token:', error);\n  }\n}\n\nasync function searchSpotify(query) {\n  const searchEndpoint = `https://api.spotify.com/v1/search?q=${encodeURIComponent(query)}&type=show,episode,track&limit=5`;\n  const headers = {\n    'Authorization': `Bearer ${accessToken}`,\n    'Content-Type': 'application/json',\n  };\n\n  try {\n    let response = await fetch(searchEndpoint, { headers: headers });\n    \n    // If token expired (status 401), refresh and retry\n    if (response.status === 401) {\n      await refreshToken();\n      response = await fetch(searchEndpoint, { headers: headers });\n    }\n\n    const data = await response.json();\n    const results = [];\n    \n    if (data.shows && data.shows.items) {\n      results.push(...data.shows.items.map(item => ({\n        type: 'show',\n        name: item.name,\n      })));\n    }\n    \n    if (data.tracks && data.tracks.items) {\n      results.push(...data.tracks.items.map(item => ({\n        type: 'track',\n        name: item.name,\n      })));\n    }\n\n    // Call the displayResults function with the search results\n    displayResults(results);\n    \n    return results;\n  } catch (error) {\n    console.error('Error searching Spotify:', error);\n    return [];\n  }\n}\n\nfunction displayResults(results) {\n  const resultsContainer = document.getElementById('searchResults');\n  resultsContainer.innerHTML = '';  // Clear previous results\n\n  results.forEach(result => {\n    const resultElement = document.createElement('div');\n    resultElement.className = 'searchResults';\n    resultElement.textContent = `${result.type}: ${result.name}`;\n    resultsContainer.appendChild(resultElement);\n  });\n}\n\n","import { setupSearch } from './searchBar.js';\n\n// Define your Spotify API Client ID\nconst clientId = '0cd96f761ce9434b9b4278b664d87591';\n\nconst loginButton = document.getElementById('loginButton');  // Reference to the login button\nloginButton.addEventListener('click', () => {\n  window.location.href = 'https://podify-backend.onrender.com/login';\n});\n\nwindow.addEventListener('load', () => {\n  const hash = window.location.hash.substring(1);\n  const hashParams = new URLSearchParams(hash);\n\n  if (hashParams.has('access_token')) {\n    loginButton.style.display = 'none';  // Hide the login button\n\n    const accessToken = hashParams.get('access_token');\n    const tokenType = hashParams.get('token_type');\n    const expiresIn = hashParams.get('expires_in');\n    const searchContainer = document.getElementById('search-container');\n    searchContainer.style.display = 'block';\n\n    console.log({\n      access_token: accessToken,\n      token_type: tokenType,\n      expires_in: expiresIn,\n    });\n\n    getUserProfile(accessToken);\n    setupSearch(accessToken);\n    document.getElementById('searchInput').style.display = 'block'; // Show the search input\n  }\n});\n\nfunction getUserProfile(accessToken) {\n  const headers = {\n    Authorization: `Bearer ${accessToken}`,\n    'Content-Type': 'application/json',\n  };\n\n  fetch('https://api.spotify.com/v1/me', { headers: headers })\n    .then(response => response.json())\n    .then(data => {\n      const username = data.display_name;\n      renderUsername(username);\n    })\n    .catch(error => {\n      console.error('Error fetching user profile:', error);\n    });\n}\n\nfunction renderUsername(username) {\n  const usernameElement = document.getElementById('username');\n  usernameElement.textContent = username;\n}\n\n"],"names":["accessToken","setupSearch","accessTokenValue","timer","document","getElementById","addEventListener","e","clearTimeout","setTimeout","async","query","searchEndpoint","encodeURIComponent","headers","response","fetch","status","localStorage","getItem","data","json","access_token","setItem","error","console","refreshToken","results","shows","items","push","map","item","type","name","tracks","resultsContainer","innerHTML","forEach","result","resultElement","createElement","className","textContent","appendChild","displayResults","searchSpotify","target","value","loginButton","window","location","href","hash","substring","hashParams","URLSearchParams","has","style","display","get","tokenType","expiresIn","log","token_type","expires_in","Authorization","then","username","display_name","catch","getUserProfile"],"sourceRoot":""}