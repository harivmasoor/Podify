{"version":3,"file":"main.js","mappings":"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","sources":["webpack://podify/./src/webPlayer.js","webpack://podify/./src/index.js","webpack://podify/./src/searchBar.js"],"sourcesContent":["// This file contains the code for the web player.\n\nlet currentAccessToken = null;\n\nexport function setupWebPlayer(accessToken) {\n    currentAccessToken = accessToken;\n\n    const searchResults = document.getElementById('searchResults');\n    searchResults.addEventListener('click', (e) => {\n        if (e.target.classList.contains('resultItem')) {\n            playItem(e.target.dataset.id, e.target.dataset.type);\n        }\n    });\n}\n\nexport async function playItem(itemId, itemType) {\n    const endpoint = `https://api.spotify.com/v1/me/player/play`;\n    const headers = {\n        'Authorization': `Bearer ${currentAccessToken}`,\n        'Content-Type': 'application/json',\n    };\n    const body = {\n        context_uri: `spotify:${itemType}:${itemId}`,\n    };\n\n    try {\n        console.log(\"Attempting to play\", body.context_uri);\n        const response = await fetch(endpoint, {\n            method: 'PUT',\n            headers: headers,\n            body: JSON.stringify(body),\n        });\n\n        if (!response.ok) {\n            const errorBody = await response.json();\n            console.error(\"Play response:\", errorBody);\n            throw new Error(`Unable to play ${itemType}: ${response.statusText}`);\n        }\n\n        console.log(`Successfully started playing ${itemType} with ID: ${itemId}`);\n    } catch (error) {\n        console.error('Error in web player:', error);\n        handlePlaybackError(error);\n    }\n    const selectedItem = Array.from(document.getElementById('searchResults').children).find(item => item.dataset.id === itemId);\n    if (selectedItem) {\n        document.getElementById('currentImage').src = selectedItem.dataset.image;\n        document.getElementById('currentTitle').textContent = selectedItem.dataset.name;\n    }\n}\n\n\nlet spotifySDKReady = new Promise((resolve) => {\n    window.onSpotifyWebPlaybackSDKReady = () => {\n        resolve();\n    };\n});\n\nexport async function checkWebPlaybackSDKCompatibility() {\n    await spotifySDKReady;  // wait for the SDK to be ready\n    return window.Spotify?.Player?.isSupported() ?? false;\n}\n\nfunction handlePlaybackError(error) {\n    console.error('Web Playback SDK error:', error);\n    // You can have custom messages or actions based on specific errors.\n    if(error.message.includes(\"Playback cannot be started from this context\")) {\n        alert('Cannot play this item. Please choose another.');\n    } else {\n        alert('Playback error. Please try again later.');\n    }\n}\n","// Description: The main JavaScript file for the Podify web app.\n\nimport { setupSearch } from './searchBar.js';\nimport { setupWebPlayer, checkWebPlaybackSDKCompatibility } from './webPlayer.js';\n\nlet updateSeekBarInterval;  // Declare the variable at a scope accessible by all your functions\nlet accessToken; // Move the declaration of accessToken to a higher scope\nlet player;  // Declare the player variable at a scope accessible by all your functions\nlet isPlaying = false;  // To track playback state\nlet currentPosition = 0;  // To track the current position of the track\nlet trackDuration = 0;  // To track the duration of the track\n\n// Function to get user's Spotify profile\nfunction getUserProfile(token) {\n    const headers = {\n        Authorization: `Bearer ${token}`,\n        'Content-Type': 'application/json',\n    };\n\n    fetch('https://api.spotify.com/v1/me', { headers: headers })\n        .then(response => response.json())\n        .then(data => {\n            const username = data.display_name;\n            renderUsername(username);\n        })\n        .catch(error => {\n            console.error('Error fetching user profile:', error);\n        });\n}\n\n// Function to render the user's name\nfunction renderUsername(username) {\n    const usernameElement = document.getElementById('username');\n    usernameElement.textContent = username;\n}\n\n// Playback control functions\nfunction togglePlay() {\n    if (isPlaying) {\n        player.pause().then(() => {\n            console.log('Paused Playback');\n            isPlaying = false;\n            document.getElementById('playPause').textContent = '▶️';\n            clearInterval(updateSeekBarInterval);  // Stop updating the seek bar\n        });\n    } else {\n        player.resume().then(() => {\n            console.log('Resumed Playback');\n            isPlaying = true;\n            document.getElementById('playPause').textContent = '⏸️';\n            updateSeekBarInterval = setInterval(updateSeekBar, 1000);  // Resume updating the seek bar\n        });\n    }\n}\n\n\nfunction rewindTrack() {\n    player.getCurrentState().then(state => {\n        if (state) {\n            const newPosition = Math.max(state.position - 15000, 0); // ensure position is not negative\n            player.seek(newPosition).then(() => {\n                console.log('Rewound 15 seconds!');\n            });\n        }\n    });\n}\n\nfunction fastForwardTrack() {\n    player.getCurrentState().then(state => {\n        if (state) {\n            const newPosition = state.position + 15000;\n            player.seek(newPosition).then(() => {\n                console.log('Fast-forwarded 15 seconds!');\n            });\n        }\n    });\n}\n\n\n// Initialize all event listeners\nfunction initializeEventListeners() {\n    // Login button event\n    const loginButton = document.getElementById('loginButton');\n    loginButton.addEventListener('click', () => {\n        window.location.href = 'https://podify-backend.onrender.com/login';\n    });\n\n    // Search input events\n    const searchInput = document.getElementById('searchInput');\n    const searchResults = document.getElementById('searchResults');\n    searchInput.addEventListener('input', () => {\n        if (searchInput.value.length > 0) {\n            searchResults.style.display = 'block';\n        } else {\n            searchResults.style.display = 'none';\n        }\n    });\n\n    searchInput.addEventListener('focus', (event) => {\n        event.preventDefault();\n    });\n\n    // Player control events\n    document.getElementById('playPause').addEventListener('click', togglePlay);\n    document.getElementById('rewind').addEventListener('click', rewindTrack);\n    document.getElementById('fastForward').addEventListener('click', fastForwardTrack);\n}\n\n// The main code that runs when the window loads\nwindow.addEventListener('load', () => {\n    const hash = window.location.hash.substring(1);\n    const hashParams = new URLSearchParams(hash);\n\n    if (hashParams.has('access_token')) {\n        document.getElementById('loginButton').style.display = 'none';  // Hide the login button\n\n        accessToken = hashParams.get('access_token'); \n        const tokenType = hashParams.get('token_type');\n        const expiresIn = hashParams.get('expires_in');\n        const searchContainer = document.getElementById('search-container');\n        searchContainer.style.display = 'block';\n\n        console.log({\n            access_token: accessToken,\n            token_type: tokenType,\n            expires_in: expiresIn,\n        });\n\n        getUserProfile(accessToken);\n        setupSearch(accessToken);\n        if (checkWebPlaybackSDKCompatibility()) {\n            setupWebPlayer(accessToken);\n        } else {\n            alert(\"Device not suitable for playback\");\n        }\n    }\n});\n\nwindow.onSpotifyWebPlaybackSDKReady = () => {\n    player = new Spotify.Player({\n        name: 'Your Web Player Name',\n        getOAuthToken: callback => {\n            callback(accessToken);\n        }\n    });\n\n    player.addListener('player_state_changed', state => {\n        console.log(state);\n        if (state) {\n            const trackDuration = state.track_window.current_track.duration_ms;\n            const currentPosition = state.position;\n    \n            document.getElementById('seekBar').max = trackDuration;\n            document.getElementById('seekBar').value = currentPosition;\n    \n            // Update the time display\n            document.getElementById('currentTime').textContent = formatTime(currentPosition);\n            document.getElementById('totalTime').textContent = formatTime(trackDuration);\n        }\n        isPlaying = !state.paused;\n        if (isPlaying) {\n            document.getElementById('playPause').textContent = '⏸️';\n        } else {\n            document.getElementById('playPause').textContent = '▶️';\n        }\n    });\n\n    player.addListener('ready', ({ device_id }) => {\n        console.log('Ready with Device ID', device_id);\n\n        updateSeekBarInterval = setInterval(updateSeekBar, 1000);  // Update the seek bar every second\n\n        // Set the device_id as the active playback device immediately.\n        const headers = {\n            'Authorization': `Bearer ${accessToken}`,\n            'Content-Type': 'application/json',\n        };\n\n        fetch('https://api.spotify.com/v1/me/player', {\n            method: 'PUT',\n            headers: headers,\n            body: JSON.stringify({\n                device_ids: [device_id],\n                play: true\n            }),\n        }).then(response => {\n            if (!response.ok) {\n                console.error('Error setting active device:', response.statusText);\n            }\n        });\n    });\n  \n    player.connect();\n};\n\ndocument.getElementById('webPlayer').style.display = 'block';\n\ndocument.getElementById('seekBar').addEventListener('input', (e) => {\n    const newPosition = e.target.value; // This will be in milliseconds\n    player.seek(newPosition).then(() => {\n        console.log(`Moved to ${newPosition} ms`);\n    });\n});\n\nfunction formatTime(ms) {\n    const totalSeconds = Math.floor(ms / 1000);\n    const minutes = Math.floor(totalSeconds / 60);\n    const seconds = totalSeconds % 60;\n    return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;\n}\n\nfunction updateSeekBar() {\n    player.getCurrentState().then(state => {\n        if (state) {\n            const currentPosition = state.position;\n            document.getElementById('seekBar').value = currentPosition;\n            document.getElementById('currentTime').textContent = formatTime(currentPosition);\n        }\n    });\n}\n\ndocument.getElementById('currentTime').textContent = formatTime(currentPosition);\ndocument.getElementById('totalTime').textContent = formatTime(trackDuration);\n\n// Initialize the event listeners\ninitializeEventListeners();\n\n\n\n","import { playItem } from './webPlayer.js'; \nlet accessToken = null;\n\nexport function setupSearch(accessTokenValue) {\n  accessToken = accessTokenValue;\n\n  const searchInput = document.getElementById('searchInput');\n  const searchResults = document.getElementById('searchResults');\n  let timer;\n\n  searchInput.addEventListener('input', (e) => {\n    if (e.target.value) {\n      searchResults.style.border = '1px solid #ccc';\n    } else {\n      searchResults.style.border = 'none';\n    }\n    clearTimeout(timer);\n    timer = setTimeout(() => {\n      searchSpotify(e.target.value);\n    }, 500);\n  });\n}\n\nasync function refreshToken() {\n  try {\n    const response = await fetch(`https://podify-backend.onrender.com/refresh_token?refresh_token=${localStorage.getItem('refresh_token')}`);\n    const data = await response.json();\n    accessToken = data.access_token;\n    localStorage.setItem('access_token', accessToken);\n  } catch (error) {\n    console.error('Error refreshing token:', error);\n  }\n}\n\nasync function searchSpotify(query) {\n  const searchEndpoint = `https://api.spotify.com/v1/search?q=${encodeURIComponent(query)}&type=artist,show,episode,track&limit=5`;\n  const headers = {\n    'Authorization': `Bearer ${accessToken}`,\n    'Content-Type': 'application/json',\n  };\n\n  try {\n    let response = await fetch(searchEndpoint, { headers: headers });\n    \n    // If token expired (status 401), refresh and retry\n    if (response.status === 401) {\n      await refreshToken();\n      response = await fetch(searchEndpoint, { headers: headers });\n    }\n\n    const data = await response.json();\n    let trackResults = [];\n    let artistResults = [];\n    let episodeResults = [];\n    let showResults = [];\n\n    // Extract and structure data for tracks\n    if (data.tracks && data.tracks.items) {\n      trackResults = data.tracks.items.map(item => ({\n          type: 'track',\n          id: item.id,\n          name: item.name,\n          image: item.album.images[0].url,\n          popularity: item.popularity\n      }));\n    }\n\n    // Extract and structure data for artists\n    if (data.artists && data.artists.items) {\n      artistResults = data.artists.items.map(item => ({\n          type: 'artist',\n          id: item.id,\n          name: item.name,\n          image: item.images[0] ? item.images[0].url : null,\n          popularity: item.popularity\n      }));\n    }\n    \n    if (data.episodes && data.episodes.items) {\n      episodeResults = data.episodes.items.map(item => ({\n          type: 'episode',\n          id: item.id,\n          name: item.name,\n          image: item.images[0].url\n      }));\n    }\n    if (data.shows && data.shows.items) {\n      showResults.push(...data.shows.items.map(item => ({\n        type: 'show',\n        id: item.id,\n        name: item.name,\n        image: item.images[0]?.url || '',\n      })));\n    }\n    if (data.artists && data.artists.items) {\n  artistResults.push(...data.artists.items.map(item => ({\n    type: 'artist',\n    id: item.id,\n    name: item.name,\n    image: item.images[0]?.url || '', // Use the first image or an empty string as a fallback\n  })));\n}\n\n\n    // Sort tracks and artists by popularity\n    trackResults.sort((a, b) => b.popularity - a.popularity);\n    artistResults.sort((a, b) => b.popularity - a.popularity);\n\n    // Combine the results in desired order\n    const results = [...showResults,...trackResults, ...artistResults, ...episodeResults];\n\n    // Call the displayResults function with the search results\n    displayResults(results);\n    \n    return results;\n  } catch (error) {\n    console.error('Error searching Spotify:', error);\n    return [];\n  }\n}\n\n\nfunction displayResults(results) {\n  const resultsContainer = document.getElementById('searchResults');\n  resultsContainer.innerHTML = '';\n\n  const episodeResults = results.filter(result => result.type === 'episode');\n  const trackResults = results.filter(result => result.type === 'track');\n  const artistResults = results.filter(result => result.type === 'artist');\n  const showResults = results.filter(result => result.type === 'show');\n\nif (artistResults.length > 0) {\n  const geniusHeader = document.createElement('h2');\n  geniusHeader.textContent = 'Geniuses';\n  resultsContainer.appendChild(geniusHeader);\n\n  artistResults.forEach(result => appendResultToContainer(result, resultsContainer));\n}\n\nif (showResults.length > 0) {\n  const mogulHeader = document.createElement('h2');\n  mogulHeader.textContent = 'Moguls';\n  resultsContainer.appendChild(mogulHeader);\n\n  showResults.forEach(result => appendResultToContainer(result, resultsContainer));\n}\n  if (episodeResults.length > 0) {\n    const podHeader = document.createElement('h2');\n    podHeader.textContent = 'Pods';\n    resultsContainer.appendChild(podHeader);\n\n    episodeResults.forEach(result => appendResultToContainer(result, resultsContainer));\n  }\n\n  if (trackResults.length > 0) {\n    const bangerHeader = document.createElement('h2');\n    bangerHeader.textContent = 'Bangers';\n    resultsContainer.appendChild(bangerHeader);\n\n    trackResults.forEach(result => appendResultToContainer(result, resultsContainer));\n  }\n}\n\nfunction appendResultToContainer(result, container) {\n  const resultElement = document.createElement('div');\n  resultElement.className = 'resultItem';\n  resultElement.dataset.id = result.id;\n  resultElement.dataset.type = result.type;\n  resultElement.dataset.name = result.name;\n  resultElement.dataset.image = result.image;\n  resultElement.innerHTML = `<img src=\"${result.image}\" alt=\"${result.name}\"/> ${result.name}`;\n  resultElement.addEventListener('click', handleResultClick);\n  container.appendChild(resultElement);\n}\n\n\nasync function handleResultClick(e) {\n  const type = e.currentTarget.dataset.type;\n  const id = e.currentTarget.dataset.id;\n\n  if (type === 'artist') {\n    await getArtistTopTracks(id);\n  } else if (type === 'show') {\n    await getShowEpisodes(id);\n  } else if (type === 'track' || type === 'episode') {\n    playItem(id, type);\n  }\n}\n\n\n\nasync function getArtistTopTracks(artistId) {\n  const topTracksEndpoint = `https://api.spotify.com/v1/artists/${artistId}/top-tracks?market=US`;\n  const headers = {\n    'Authorization': `Bearer ${accessToken}`,\n    'Content-Type': 'application/json',\n  };\n\n  try {\n    let response = await fetch(topTracksEndpoint, { headers: headers });\n\n    if (response.status === 401) {\n      await refreshToken();\n      response = await fetch(topTracksEndpoint, { headers: headers });\n    }\n\n    const data = await response.json();\n    const topTracks = data.tracks.map(track => ({\n      type: 'track',\n      id: track.id,\n      name: track.name,\n      image: track.album.images[0].url,\n    }));\n\n    displayResults(topTracks);\n\n  } catch (error) {\n    console.error('Error getting artist top tracks:', error);\n  }\n}\n\n\nasync function getShowEpisodes(showId) {\n  const episodesEndpoint = `https://api.spotify.com/v1/shows/${showId}/episodes?market=US&limit=10`;\n  const headers = {\n    'Authorization': `Bearer ${accessToken}`,\n    'Content-Type': 'application/json',\n  };\n\n  try {\n    let response = await fetch(episodesEndpoint, { headers: headers });\n\n    if (response.status === 401) {\n      await refreshToken();\n      response = await fetch(episodesEndpoint, { headers: headers });\n    }\n\n    const data = await response.json();\n    const episodes = data.items.map(episode => ({\n      type: 'episode',\n      id: episode.id,\n      name: episode.name,\n      image: episode.images[0].url,\n    }));\n\n    displayResults(episodes);\n\n  } catch (error) {\n    console.error('Error getting show episodes:', error);\n  }\n}\n\n\n\n"],"names":["currentAccessToken","async","playItem","itemId","itemType","headers","body","context_uri","console","log","response","fetch","method","JSON","stringify","ok","errorBody","json","error","Error","statusText","message","includes","alert","handlePlaybackError","selectedItem","Array","from","document","getElementById","children","find","item","dataset","id","src","image","textContent","name","updateSeekBarInterval","accessToken","player","spotifySDKReady","Promise","resolve","window","onSpotifyWebPlaybackSDKReady","refreshToken","localStorage","getItem","data","access_token","setItem","displayResults","results","resultsContainer","innerHTML","episodeResults","filter","result","type","trackResults","artistResults","showResults","length","geniusHeader","createElement","appendChild","forEach","appendResultToContainer","mogulHeader","podHeader","bangerHeader","container","resultElement","className","addEventListener","handleResultClick","e","currentTarget","artistId","topTracksEndpoint","status","tracks","map","track","album","images","url","getArtistTopTracks","showId","episodesEndpoint","items","episode","getShowEpisodes","isPlaying","togglePlay","pause","then","clearInterval","resume","setInterval","updateSeekBar","rewindTrack","getCurrentState","state","newPosition","Math","max","position","seek","fastForwardTrack","formatTime","ms","totalSeconds","floor","seconds","currentPosition","value","hash","location","substring","hashParams","URLSearchParams","has","style","display","get","tokenType","expiresIn","token_type","expires_in","Authorization","username","display_name","catch","accessTokenValue","searchInput","searchResults","timer","target","border","clearTimeout","setTimeout","query","searchEndpoint","encodeURIComponent","popularity","artists","episodes","shows","push","sort","a","b","searchSpotify","setupSearch","Spotify","Player","isSupported","checkWebPlaybackSDKCompatibility","classList","contains","setupWebPlayer","getOAuthToken","callback","addListener","trackDuration","track_window","current_track","duration_ms","paused","_ref","device_id","device_ids","play","connect","href","event","preventDefault","initializeEventListeners"],"sourceRoot":""}